

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Below are the MODTRAN scripts &mdash; FELLOW_project 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> FELLOW_project
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intro.html">This is an introduction to my documentation!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ODESSA_docs/ODESSA_dir.html">ODESSA Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="MODTRAN_dir.html">MODTRAN Wrapping Function</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">FELLOW_project</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Below are the MODTRAN scripts</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/MODTRAN_docs/MODTRAN.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="below-are-the-modtran-scripts">
<h1>Below are the MODTRAN scripts<a class="headerlink" href="#below-are-the-modtran-scripts" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-pythonfinal">
<span id="module"></span><h2>Module<a class="headerlink" href="#module-pythonfinal" title="Permalink to this headline">¶</a></h2>
<p>A specialized interface to generate a generic tape 5 file
for MODTRAN, run the executable, and parse the tape 7 file. The tape 5
file is derived from a very basic input to MODTRAN with modifications
based on the inputs used by the DSM. The knobs that we can tune are:
the model via a string representation, the water content via the
relative humidity, the haze via a fixed string, and the visibility. We
provide a class for inter-operating with a single run and a means to
drive the class via the command line. More information on the analysis
and choices for the model are on <a href="#id8"><span class="problematic" id="id9">Confluence_</span></a>. This makes use of the
<a href="#id10"><span class="problematic" id="id11">PyModtran_</span></a> module developed by EOSL.</p>
<p>_Confluence: <a class="reference external" href="https://eoslcm.gatech.edu/confluence/display/PROJ/%28S%29+Atmospheric+Validation">https://eoslcm.gatech.edu/confluence/display/PROJ/%28S%29+Atmospheric+Validation</a>
_PyModtran: <a class="reference external" href="https://eoslcm.gatech.edu/bitbucket/users/kprussing3/repos/u-pymodtran/browse">https://eoslcm.gatech.edu/bitbucket/users/kprussing3/repos/u-pymodtran/browse</a></p>
<dl class="py class">
<dt id="pythonfinal.Modtran">
<em class="property">class </em><code class="sig-prename descclassname">pythonfinal.</code><code class="sig-name descname">Modtran</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">MODEL</span><span class="o">=</span><span class="default_value">'US_STANDARD_1976'</span></em>, <em class="sig-param"><span class="n">RH</span><span class="o">=</span><span class="default_value">50</span></em>, <em class="sig-param"><span class="n">IHAZE</span><span class="o">=</span><span class="default_value">'RURAL'</span></em>, <em class="sig-param"><span class="n">VIS</span><span class="o">=</span><span class="default_value">16</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pythonfinal.Modtran" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the main class for interacting with MODTRAN within this
project. It handles defining the default tape 5 file along with the
customizations allowed. It helps write out the run(s) to disk and
running MODTRAN (5.3.2 and 6.0) along with loading the results from
the tape 7 file. The default is the U.S. standard 1976 rural
atmosphere with 50% humidity and 16 km visibility.</p>
<dl class="py attribute">
<dt id="pythonfinal.Modtran.tape5">
<code class="sig-name descname">tape5</code><a class="headerlink" href="#pythonfinal.Modtran.tape5" title="Permalink to this definition">¶</a></dt>
<dd><p>The composite tape 5 for the run. This could be done as one
whole job if it is of reasonable size.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>:class:’pymodtran.tape5.TAPE5’</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pythonfinal.Modtran.files">
<code class="sig-name descname">files</code><a class="headerlink" href="#pythonfinal.Modtran.files" title="Permalink to this definition">¶</a></dt>
<dd><p>The list of tape 5 file names written.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pythonfinal.Modtran.MODEL">
<code class="sig-name descname">MODEL</code><a class="headerlink" href="#pythonfinal.Modtran.MODEL" title="Permalink to this definition">¶</a></dt>
<dd><p>The key for customizing the model. See the MODELS attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pythonfinal.Modtran.RH">
<code class="sig-name descname">RH</code><a class="headerlink" href="#pythonfinal.Modtran.RH" title="Permalink to this definition">¶</a></dt>
<dd><p>The relative humidity. See H2OSTRS for valid values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pythonfinal.Modtran.IHAZE">
<code class="sig-name descname">IHAZE</code><a class="headerlink" href="#pythonfinal.Modtran.IHAZE" title="Permalink to this definition">¶</a></dt>
<dd><p>The key for the haze model. See IHAZES for valid values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pythonfinal.Modtran.VIS">
<code class="sig-name descname">VIS</code><a class="headerlink" href="#pythonfinal.Modtran.VIS" title="Permalink to this definition">¶</a></dt>
<dd><p>The visibility for the run in kilometers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pythonfinal.Modtran.H2OSTRS">
<code class="sig-name descname">H2OSTRS</code><em class="property"> = {20: '+0.265', 35: '+0.462', 50: '+0.658', 60: '+0.8', 65: '+0.855', 75: '+0.985', 80: '+1.051', 95: '+1.248'}</em><a class="headerlink" href="#pythonfinal.Modtran.H2OSTRS" title="Permalink to this definition">¶</a></dt>
<dd><p>Mappings of humidities to water content from analysis</p>
</dd></dl>

<dl class="py method">
<dt id="id0">
<em class="property">property </em><code class="sig-name descname">IHAZE</code><a class="headerlink" href="#id0" title="Permalink to this definition">¶</a></dt>
<dd><p>The haze model</p>
</dd></dl>

<dl class="py attribute">
<dt id="pythonfinal.Modtran.IHAZES">
<code class="sig-name descname">IHAZES</code><em class="property"> = {'DESERT': 10, 'FOG-ADVECTIVE': 8, 'FOG-RADIATIVE': 9, 'MARITIME': 4, 'MARITIME-NAVY': 3, 'RURAL': 1, 'RURAL-DENSE': 2, 'TROPOSPHERIC': 6, 'URBAN': 5}</em><a class="headerlink" href="#pythonfinal.Modtran.IHAZES" title="Permalink to this definition">¶</a></dt>
<dd><p>Mappings of haze levels to MODTRAN IHAZE</p>
</dd></dl>

<dl class="py method">
<dt id="id1">
<em class="property">property </em><code class="sig-name descname">MODEL</code><a class="headerlink" href="#id1" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the symbolic reference to the model</p>
</dd></dl>

<dl class="py attribute">
<dt id="pythonfinal.Modtran.MODELS">
<code class="sig-name descname">MODELS</code><em class="property"> = {'MIDLAT_SUMMER': 2, 'MIDLAT_WINTER': 3, 'SUBARCTIC_SUMMER': 4, 'SUBARCTIC_WINTER': 5, 'TROPICAL': 1, 'US_STANDARD_1976': 6}</em><a class="headerlink" href="#pythonfinal.Modtran.MODELS" title="Permalink to this definition">¶</a></dt>
<dd><p>The mappings of symbolic atmospheres to the MODTRAN model</p>
</dd></dl>

<dl class="py method">
<dt id="id2">
<em class="property">property </em><code class="sig-name descname">RH</code><a class="headerlink" href="#id2" title="Permalink to this definition">¶</a></dt>
<dd><p>The relative humidity</p>
</dd></dl>

<dl class="py method">
<dt id="id3">
<em class="property">property </em><code class="sig-name descname">VIS</code><a class="headerlink" href="#id3" title="Permalink to this definition">¶</a></dt>
<dd><p>Visibility</p>
</dd></dl>

<dl class="py method">
<dt id="pythonfinal.Modtran.add_geom">
<code class="sig-name descname">add_geom</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1</span></em>, <em class="sig-param"><span class="n">h2</span></em>, <em class="sig-param"><span class="n">hr</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pythonfinal.Modtran.add_geom" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a geometry to run</p>
<p>This is the simply observer altitude (H1ALT), target altitude
(H2ALT), and the slant range (HRANGE) from CARD3. We demand that
the geometry be physically realizable (HRANGE must be larger than
the difference between altitudes).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>h1</strong> (<em>float</em>) – Altitude of the observer in kilometers</p></li>
<li><p><strong>h2</strong> (<em>float</em>) – Altitude of the target in kilometers</p></li>
<li><p><strong>hr</strong> (<em>float</em>) – Slant range between the target and observer in kilometers</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pythonfinal.Modtran.clear_geoms">
<code class="sig-name descname">clear_geoms</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pythonfinal.Modtran.clear_geoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove all gemoetries from the object</p>
<p>We could conceivably want to run multiple discrete geometries
with the same configured atmosphere. In that case, we need to
clear out all the information from previous runs so we can start
adding geometries</p>
</dd></dl>

<dl class="py method">
<dt id="pythonfinal.Modtran.convert_h2o">
<code class="sig-name descname">convert_h2o</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pythonfinal.Modtran.convert_h2o" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts the given relative humidity value and generates an approximate
scale for the model’s data. Takes the user’s input Relhum value and the
given model type.</p>
</dd></dl>

<dl class="py method">
<dt id="pythonfinal.Modtran.init_run">
<em class="property">classmethod </em><code class="sig-name descname">init_run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pythonfinal.Modtran.init_run" title="Permalink to this definition">¶</a></dt>
<dd><p>Initiate a blank run</p>
</dd></dl>

<dl class="py method">
<dt id="pythonfinal.Modtran.load_results">
<code class="sig-name descname">load_results</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pythonfinal.Modtran.load_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Load all results associated with this run</p>
<p>Each tape 5 file generated will produce an associated tape 7
file. We have already stored the path to the tape 5 so all we
have to do is loop over the list and load the tape7. It is up
to the user to run MODTRAN before calling this method. This
method will throw a :class:’RuntimeError’ if a tape 7 does not
exist for one of the tape 5 files, but it will report all tape 7
files that are missing before raising the error.</p>
</dd></dl>

<dl class="py method">
<dt id="pythonfinal.Modtran.runs">
<em class="property">property </em><code class="sig-name descname">runs</code><a class="headerlink" href="#pythonfinal.Modtran.runs" title="Permalink to this definition">¶</a></dt>
<dd><p>Provides access to the MODTRAN run natrually</p>
</dd></dl>

<dl class="py method">
<dt id="pythonfinal.Modtran.update_itype">
<code class="sig-name descname">update_itype</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pythonfinal.Modtran.update_itype" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the ITYPE on CARD1 based on the CARD3 information</p>
</dd></dl>

<dl class="py method">
<dt id="pythonfinal.Modtran.write">
<code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file</span></em>, <em class="sig-param"><span class="n">njobs</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pythonfinal.Modtran.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the runs to file</p>
<p>Before we can run MODTRAN, we need to write out the tape 5
file(s). In the simplest case, we have one file to write. For
complex batching, we may want to break up the full queue into
multiple tape 5 files. We need to handle the batching procedure
in one location so we do it on write out. We will store the
names of the tape 5 files so that we can later read in the
file root (with or without the ‘.tp5’) and add a counter tag to
the end for the different files. For a single job, we want to
allow the user to provide an open file handle; however, we need
to make sure the user opened a file with the correct name. This
means the file name must be ‘tape5’ (bad idea) or end with
‘.tp5’. This will through a :class:’RuntimeError’ if given a bad
file name or a file handle is passed to ‘’file’’ with ‘’njobs’’
not equal to 1. This does run the :func:’update_itype’ method
to set the correct repeat flag on the whole batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<em>file like object</em><em> or </em><em>str</em>) – The open file handle (njobs==1) or the root for the tape 5</p></li>
<li><p><strong>njobs</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of jobs used for batching runs</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pythonfinal.gen_output">
<code class="sig-prename descclassname">pythonfinal.</code><code class="sig-name descname">gen_output</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">args</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pythonfinal.gen_output" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function for generating a file root</p>
</dd></dl>

<dl class="py function">
<dt id="pythonfinal.generate">
<code class="sig-prename descclassname">pythonfinal.</code><code class="sig-name descname">generate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">relhum</span></em>, <em class="sig-param"><span class="n">haze</span></em>, <em class="sig-param"><span class="n">vis</span></em>, <em class="sig-param"><span class="n">h1</span></em>, <em class="sig-param"><span class="n">h2</span></em>, <em class="sig-param"><span class="n">hr</span></em>, <em class="sig-param"><span class="n">output</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pythonfinal.generate" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a tape 5 file for a single geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>str</em>) – The MODEL for :class:’Modtran’</p></li>
<li><p><strong>relhum</strong> (<em>float</em>) – The relative humidity (RH) for :class:’Modtran’</p></li>
<li><p><strong>haze</strong> (<em>str</em>) – The IHAZE for :class:’Modtran’</p></li>
<li><p><strong>vis</strong> (<em>float</em>) – The visibility (VIS) for :class:’Modtran’ in kilometers</p></li>
<li><p><strong>h1</strong> (<em>float</em>) – The observer altitude in kilometers</p></li>
<li><p><strong>h2</strong> (<em>float</em>) – The target altitude in kilometers</p></li>
<li><p><strong>hr</strong> (<em>float</em>) – The slant range in kilometers</p></li>
<li><p><strong>output</strong> (<em>str</em><em> or </em><em>file like object</em>) – The file to which to write</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>mod</strong> (<em>:class:’Modtran’</em>)</p></li>
<li><p><em>The MODTRAN interface object</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pythonfinal.run">
<code class="sig-prename descclassname">pythonfinal.</code><code class="sig-name descname">run</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tape5</span></em>, <em class="sig-param"><span class="n">modtran</span></em>, <em class="sig-param"><span class="n">datdir</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">allfiles</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pythonfinal.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run MODTRAN on a tape 5</p>
<p>Given a tape 5 file, we can run MODTRAN 5.3.2 or 6.0 using the
mod5root convention. But, we need to properly construct the command
line and move to a temporary location so as to not pollute the
current working directory or cause file conflicts. To do this, the
user needs to specify a MODTRAN via a string or an integer. From
that, we can construct a default path to the data directory, but we
provide a way for the user to override that if desired. We also
only worry about copying back the tape 7 and tape 6 files unless the
user wants all the files. This method will raise a
:class:’RuntimeError’ if it cannot resolve he MODTRAN executable or
cannot locate the data directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tape5</strong> (<em>str</em>) – The path to the tape 5 file to run (must end in ‘.tp5’)</p></li>
<li><p><strong>modtran</strong> (<em>str</em><em> or </em><em>int</em>) – The name of the MODTRAN executable (‘mod53’ or ‘mod6c_cons’) or
the integer version (5 or 6)</p></li>
<li><p><strong>datadir</strong> (<em>str</em><em>, </em><em>optional</em>) – The user specified path to the MODTRAN data directory. Defaults
to ‘usr/local/gtsims/data/modtran5.3.2/DATA/’ or
‘usr/global/apps/MODTRAN6.0/DATA’ as appropriate</p></li>
<li><p><strong>allfiles</strong> (<em>bool</em><em>, </em><em>optional</em>) – Copy all MODTRAN output files back when complete</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>retcode</strong> – The return code from the MODTRAN process</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pythonfinal.transmittance">
<code class="sig-prename descclassname">pythonfinal.</code><code class="sig-name descname">transmittance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">relhum</span></em>, <em class="sig-param"><span class="n">haze</span></em>, <em class="sig-param"><span class="n">vis</span></em>, <em class="sig-param"><span class="n">h1</span></em>, <em class="sig-param"><span class="n">h2</span></em>, <em class="sig-param"><span class="n">hr</span></em>, <em class="sig-param"><span class="n">modtran</span></em>, <em class="sig-param"><span class="n">datdir</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">keep</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pythonfinal.transmittance" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the transmittance for a geometry</p>
<p>This is a convenience function to compute a single line of sight
transmittance in a given atmosphere. It instantiates a MODTRAN run
using the given model, relative humidity, haze, visibility, and
viewing geometry, runs the given MODTRAN version, and finally read
the transmittance from the resultant tape 7. All of the work is
done in a temporary directory and the files are discarded after the
run unless flagged otherwise. If the files are key, the file names
are generated from the input arguments and are written to the
current directory. No effort is made to prevent name collision.
This method :func:’generate’ and :func:’run” to do most of the
work and the appropriate parameters are passed along to those
methods. This method will raise a :class:’RuntimeError’ if
:func:’run’ returns a none zero code.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>str</em>) – The MODEL for :class:’Modtran’</p></li>
<li><p><strong>relhum</strong> (<em>float</em>) – The relative humidity (RH) for :class:’Modtran’</p></li>
<li><p><strong>haze</strong> (<em>str</em>) – The IHAZE for :class:’Modtran’</p></li>
<li><p><strong>vis</strong> (<em>float</em>) – The visbility (VIS) for :class:’Modtran’ in kilometers</p></li>
<li><p><strong>h1</strong> (<em>float</em>) – The observer altitude in kilometers</p></li>
<li><p><strong>h2</strong> (<em>float</em>) – The target altitude in kilometers</p></li>
<li><p><strong>hr</strong> (<em>float</em>) – The slant range in kilometers</p></li>
<li><p><strong>modtran</strong> (<em>str</em><em> or </em><em>int</em>) – The name of the MODTRAN executable (‘mod53’ or ‘mod6c_cons’) or
the integer version (5 or 6)</p></li>
<li><p><strong>datadir</strong> (<em>str</em><em>, </em><em>optional</em>) – The user specified path to the MODTRAN data directory. Defaults
to ‘usr/local/gtsims/data/modtran5.3.2/DATA/’ or
‘usr/global/apps/MODTRAN6.0/DATA’ as appropriate</p></li>
<li><p><strong>keep</strong> (<em>bool</em><em>, </em><em>optional</em>) – Copy all MODTRAN output files back when complete</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>wavelengths</strong> (<em>:class:’numpy.ndarray’</em>) – The wavelengths used in the calculation</p></li>
<li><p><strong>transmittance</strong> (<em>:class:’numpy.ndarray’</em>) – The spectral transmittance at each wavelength</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-GraphTesterH2O"></span><p>A specialized interface to compare two versions of MODTRAN,
generate a graph of the different values, and store the differences to a
separate file for later use. This is part of a larger script, and may not
work if run independently. It takes in 2 tape 7 files generated from the
two different versions of H2OSTR values, extracts their transmittance, and then
appends the file along with creating a series of graphs to more easily analyze
the differences. Three graphs are generated: a basic graph with the transmittance
values of the two versions overlaid with each other, a graph showing the values
of the differences between the versions, and a histogram of the differences
overlaid with an expected curve, based on the data’s mean and standard deviation.
This uses the class created by Dr. Keith Prussing with EOSL, as well as the
<a href="#id12"><span class="problematic" id="id13">PyModtran_</span></a> module developed by EOSL and the H2OConverter developed by myself.</p>
<p>_Confluence: <a class="reference external" href="https://eoslcm.gatech.edu/confluence/display/PROJ/%28S%29+Atmospheric+Validation">https://eoslcm.gatech.edu/confluence/display/PROJ/%28S%29+Atmospheric+Validation</a>
_PyModtran: <a class="reference external" href="https://eoslcm.gatech.edu/bitbucket/users/kprussing3/repos/u-pymodtran/browse">https://eoslcm.gatech.edu/bitbucket/users/kprussing3/repos/u-pymodtran/browse</a></p>
<dl class="py class">
<dt id="GraphTesterH2O.Modtran">
<em class="property">class </em><code class="sig-prename descclassname">GraphTesterH2O.</code><code class="sig-name descname">Modtran</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">MODEL</span><span class="o">=</span><span class="default_value">'US_STANDARD_1976'</span></em>, <em class="sig-param"><span class="n">RH</span><span class="o">=</span><span class="default_value">50</span></em>, <em class="sig-param"><span class="n">IHAZE</span><span class="o">=</span><span class="default_value">'RURAL'</span></em>, <em class="sig-param"><span class="n">VIS</span><span class="o">=</span><span class="default_value">16</span></em><span class="sig-paren">)</span><a class="headerlink" href="#GraphTesterH2O.Modtran" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the main class for interacting with MODTRAN within this
project. It handles defining the default tape 5 file along with the
customization allowed. It helps write out the run(s) to disk and
running MODTRAN (5.3.2 and 6.0) along with loading the results from
the tape 7 file. The default is the U.S. standard 1976 rural
atmosphere with 50% humidity and 16 km visibility.</p>
<dl class="py attribute">
<dt id="GraphTesterH2O.Modtran.tape5">
<code class="sig-name descname">tape5</code><a class="headerlink" href="#GraphTesterH2O.Modtran.tape5" title="Permalink to this definition">¶</a></dt>
<dd><p>The composite tape 5 for the run. This could be done as one
whole job if it is of reasonable size.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>:class:’pymodtran.tape5.TAPE5’</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="GraphTesterH2O.Modtran.files">
<code class="sig-name descname">files</code><a class="headerlink" href="#GraphTesterH2O.Modtran.files" title="Permalink to this definition">¶</a></dt>
<dd><p>The list of tape 5 file names written.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="GraphTesterH2O.Modtran.MODEL">
<code class="sig-name descname">MODEL</code><a class="headerlink" href="#GraphTesterH2O.Modtran.MODEL" title="Permalink to this definition">¶</a></dt>
<dd><p>The key for customizing the model. See the MODELS attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="GraphTesterH2O.Modtran.RH">
<code class="sig-name descname">RH</code><a class="headerlink" href="#GraphTesterH2O.Modtran.RH" title="Permalink to this definition">¶</a></dt>
<dd><p>The relative humidity. See H2OSTRS for valid values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="GraphTesterH2O.Modtran.IHAZE">
<code class="sig-name descname">IHAZE</code><a class="headerlink" href="#GraphTesterH2O.Modtran.IHAZE" title="Permalink to this definition">¶</a></dt>
<dd><p>The key for the haze model. See IHAZES for valid values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="GraphTesterH2O.Modtran.VIS">
<code class="sig-name descname">VIS</code><a class="headerlink" href="#GraphTesterH2O.Modtran.VIS" title="Permalink to this definition">¶</a></dt>
<dd><p>The visibility for the run in kilometers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="GraphTesterH2O.Modtran.H2OSTRS">
<code class="sig-name descname">H2OSTRS</code><em class="property"> = {20: '0.265', 35: '0.462', 50: '0.658', 60: '0.8', 65: '0.855', 75: '0.985', 80: '1.051', 95: '1.248'}</em><a class="headerlink" href="#GraphTesterH2O.Modtran.H2OSTRS" title="Permalink to this definition">¶</a></dt>
<dd><p>Mappings of humidities to water content from analysis</p>
</dd></dl>

<dl class="py method">
<dt id="id4">
<em class="property">property </em><code class="sig-name descname">IHAZE</code><a class="headerlink" href="#id4" title="Permalink to this definition">¶</a></dt>
<dd><p>The haze model</p>
</dd></dl>

<dl class="py attribute">
<dt id="GraphTesterH2O.Modtran.IHAZES">
<code class="sig-name descname">IHAZES</code><em class="property"> = {'DESERT': 10, 'FOG-ADVECTIVE': 8, 'FOG-RADIATIVE': 9, 'MARITIME': 4, 'MARITIME-NAVY': 3, 'RURAL': 1, 'RURAL-DENSE': 2, 'TROPOSPHERIC': 6, 'URBAN': 5}</em><a class="headerlink" href="#GraphTesterH2O.Modtran.IHAZES" title="Permalink to this definition">¶</a></dt>
<dd><p>Mappings of haze levels to MODTRAN IHAZE</p>
</dd></dl>

<dl class="py method">
<dt id="id5">
<em class="property">property </em><code class="sig-name descname">MODEL</code><a class="headerlink" href="#id5" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the symbolic reference to the model</p>
</dd></dl>

<dl class="py attribute">
<dt id="GraphTesterH2O.Modtran.MODELS">
<code class="sig-name descname">MODELS</code><em class="property"> = {'MIDLAT_SUMMER': 2, 'MIDLAT_WINTER': 3, 'SUBARCTIC_SUMMER': 4, 'SUBARCTIC_WINTER': 5, 'TROPICAL': 1, 'US_STANDARD_1976': 6}</em><a class="headerlink" href="#GraphTesterH2O.Modtran.MODELS" title="Permalink to this definition">¶</a></dt>
<dd><p>The mappings of symbolic atmospheres to the MODTRAN model</p>
</dd></dl>

<dl class="py method">
<dt id="id6">
<em class="property">property </em><code class="sig-name descname">RH</code><a class="headerlink" href="#id6" title="Permalink to this definition">¶</a></dt>
<dd><p>The relative humidity</p>
</dd></dl>

<dl class="py method">
<dt id="id7">
<em class="property">property </em><code class="sig-name descname">VIS</code><a class="headerlink" href="#id7" title="Permalink to this definition">¶</a></dt>
<dd><p>Visibility</p>
</dd></dl>

<dl class="py method">
<dt id="GraphTesterH2O.Modtran.add_geom">
<code class="sig-name descname">add_geom</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1</span></em>, <em class="sig-param"><span class="n">h2</span></em>, <em class="sig-param"><span class="n">hr</span></em><span class="sig-paren">)</span><a class="headerlink" href="#GraphTesterH2O.Modtran.add_geom" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a geometry to run</p>
<p>This is the simply observer altitude (H1ALT), target altitude
(H2ALT), and the slant range (HRANGE) frmo CARD3. We demand that
the geometry be physically realizable (HRANGE must be larger than
the difference between altitudes).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>h1</strong> (<em>float</em>) – Altitude of the observer in kilometers</p></li>
<li><p><strong>h2</strong> (<em>float</em>) – Altitude of the target in kilometers</p></li>
<li><p><strong>hr</strong> (<em>float</em>) – Slant range between the target and observer in kilometers</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="GraphTesterH2O.Modtran.clear_geoms">
<code class="sig-name descname">clear_geoms</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#GraphTesterH2O.Modtran.clear_geoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove all geometries from the object</p>
<p>We could conceivably want to run multiple discrete geometries
with the same configured atmosphere. In that case, we need to
clear out all the information from previous runs so we can start
adding geometries</p>
</dd></dl>

<dl class="py method">
<dt id="GraphTesterH2O.Modtran.convert_h2o">
<code class="sig-name descname">convert_h2o</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="headerlink" href="#GraphTesterH2O.Modtran.convert_h2o" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts the given relative humidity value and generates an approximate
scale for the model’s data.</p>
</dd></dl>

<dl class="py method">
<dt id="GraphTesterH2O.Modtran.init_run">
<em class="property">classmethod </em><code class="sig-name descname">init_run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#GraphTesterH2O.Modtran.init_run" title="Permalink to this definition">¶</a></dt>
<dd><p>Initiate a blank run</p>
</dd></dl>

<dl class="py method">
<dt id="GraphTesterH2O.Modtran.load_results">
<code class="sig-name descname">load_results</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">relhum</span></em>, <em class="sig-param"><span class="n">haze</span></em>, <em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">vis</span></em><span class="sig-paren">)</span><a class="headerlink" href="#GraphTesterH2O.Modtran.load_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Load all results associated with this run</p>
<p>Each tape 5 file generated will produce an associated tape 7
file. We have already stored the path to the tape 5 so all we
have to do is loop over the list and load the tape7. It is up
to the user to run MODTRAN before calling this method. This
method will throw a :class:’RuntimeError’ if a tape 7 does not
exist for one of the tape 5 files, but it will report all tape 7
files that are missing before raising the error. Tape 72 is a
Tape 7 file generated from a run using the calculated H2OSTR value. As this method is still used
to compare the values between H2OSTR values, we ensure that it looks
up the Tape 7 file correlated to the run version.</p>
</dd></dl>

<dl class="py method">
<dt id="GraphTesterH2O.Modtran.runs">
<em class="property">property </em><code class="sig-name descname">runs</code><a class="headerlink" href="#GraphTesterH2O.Modtran.runs" title="Permalink to this definition">¶</a></dt>
<dd><p>Provides access to the MODTRAN run natrually</p>
</dd></dl>

<dl class="py method">
<dt id="GraphTesterH2O.Modtran.update_itype">
<code class="sig-name descname">update_itype</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#GraphTesterH2O.Modtran.update_itype" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the ITYPE on CARD1 based on the CARD3 information</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="GraphTesterH2O.generate">
<code class="sig-prename descclassname">GraphTesterH2O.</code><code class="sig-name descname">generate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">relhum</span></em>, <em class="sig-param"><span class="n">haze</span></em>, <em class="sig-param"><span class="n">vis</span></em>, <em class="sig-param"><span class="n">h1</span></em>, <em class="sig-param"><span class="n">h2</span></em>, <em class="sig-param"><span class="n">hr</span></em>, <em class="sig-param"><span class="n">output</span></em><span class="sig-paren">)</span><a class="headerlink" href="#GraphTesterH2O.generate" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a tape 5 file for a single geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>str</em>) – The MODEL for :class:’Modtran’</p></li>
<li><p><strong>relhum</strong> (<em>float</em>) – The relative humidity (RH) for :class:’Modtran’</p></li>
<li><p><strong>haze</strong> (<em>str</em>) – The IHAZE for :class:’Modtran’</p></li>
<li><p><strong>vis</strong> (<em>float</em>) – The visibility (VIS) for :class:’Modtran’ in kilometers</p></li>
<li><p><strong>h1</strong> (<em>float</em>) – The observer altitude in kilometers</p></li>
<li><p><strong>h2</strong> (<em>float</em>) – The target altitude in kilometers</p></li>
<li><p><strong>hr</strong> (<em>float</em>) – The slant range in kilometers</p></li>
<li><p><strong>output</strong> (<em>str</em><em> or </em><em>file like object</em>) – The file to which to write</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>mod</strong> (<em>:class:’Modtran’</em>)</p></li>
<li><p><em>The MODTRAN interface object</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="GraphTesterH2O.transmittance">
<code class="sig-prename descclassname">GraphTesterH2O.</code><code class="sig-name descname">transmittance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">relhum</span></em>, <em class="sig-param"><span class="n">haze</span></em>, <em class="sig-param"><span class="n">vis</span></em>, <em class="sig-param"><span class="n">h1</span></em>, <em class="sig-param"><span class="n">h2</span></em>, <em class="sig-param"><span class="n">hr</span></em>, <em class="sig-param"><span class="n">datdir</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">keep</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#GraphTesterH2O.transmittance" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the transmittance for a geometry</p>
<p>This is a convenience function to compute a single line of sight
transmittance in a given atmosphere. It reads the transmittance values
from the two tape 7 files earlier generated. All of the work is
done in a temporary directory and the files are discarded after the
run unless flagged otherwise. If the files are key, the file names
are generated from the input arguments and are written to the
current directory. No effort is made to prevent name collision.
This method :func:’generate’ and :func:’run” to do most of the
work and the appropriate parameters are passed along to those
methods. This method will raise a :class:’RuntimeError’ if
:func:’run’ returns a none zero code.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>str</em>) – The MODEL for :class:’Modtran’</p></li>
<li><p><strong>relhum</strong> (<em>float</em>) – The relative humidity (RH) for :class:’Modtran’</p></li>
<li><p><strong>haze</strong> (<em>str</em>) – The IHAZE for :class:’Modtran’</p></li>
<li><p><strong>vis</strong> (<em>float</em>) – The visibility (VIS) for :class:’Modtran’ in kilometers</p></li>
<li><p><strong>h1</strong> (<em>float</em>) – The observer altitude in kilometers</p></li>
<li><p><strong>h2</strong> (<em>float</em>) – The target altitude in kilometers</p></li>
<li><p><strong>hr</strong> (<em>float</em>) – The slant range in kilometers</p></li>
<li><p><strong>datadir</strong> (<em>str</em><em>, </em><em>optional</em>) – The user specified path to the MODTRAN data directory. Defaults
to ‘usr/local/gtsims/data/modtran5.3.2/DATA/’ or
‘usr/global/apps/MODTRAN6.0/DATA’ as appopriate</p></li>
<li><p><strong>keep</strong> (<em>bool</em><em>, </em><em>optional</em>) – Copy all MODTRAN output files back when complete</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>wavelengths</strong> (<em>:class:’numpy.ndarray’</em>) – The wavelengths from the given H2OSTR values used in the calculation</p></li>
<li><p><strong>transmittance</strong> (<em>:class:’numpy.ndarray’</em>) – The spectral transmittance from the given H2OSTR values at each wavelength</p></li>
<li><p><strong>wavelengths2</strong> (<em>:class:’numpy.ndarray’</em>) – The wavelengths from the calculated H2OSTR values used in the calculation</p></li>
<li><p><strong>transmittance2</strong> (<em>:class:’numpy.ndarray’</em>) – The spectral transmittance from calculated H2OSTR values at each wavelength</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, John Lewis Corker

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>