

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>This shows the documentation of my ODESSA scripts! &mdash; FELLOW_project 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> FELLOW_project
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intro.html">This is an introduction to my documentation!</a></li>
<li class="toctree-l1"><a class="reference internal" href="ODESSA_dir.html">ODESSA Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MODTRAN_docs/MODTRAN_dir.html">MODTRAN Wrapping Function</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">FELLOW_project</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>This shows the documentation of my ODESSA scripts!</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/ODESSA_docs/ODESSA.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="this-shows-the-documentation-of-my-odessa-scripts">
<h1>This shows the documentation of my ODESSA scripts!<a class="headerlink" href="#this-shows-the-documentation-of-my-odessa-scripts" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-MCMC">
<span id="module"></span><h2>Module<a class="headerlink" href="#module-MCMC" title="Permalink to this headline">¶</a></h2>
<p>A function to perform Markov Chain Monte Carlo on the sample distributions
generated in stat_dists.py</p>
<p>Of note is that technically the sample distributions are Markov Chains sampled
from the base distribution</p>
<p>&#64;author John Lewis Corker</p>
<dl class="py function">
<dt id="MCMC.AHMC">
<code class="sig-prename descclassname">MCMC.</code><code class="sig-name descname">AHMC</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">curr_theta</span></em>, <em class="sig-param"><span class="n">init_L</span><span class="o">=</span><span class="default_value">70</span></em>, <em class="sig-param"><span class="n">init_e</span><span class="o">=</span><span class="default_value">0.02</span></em>, <em class="sig-param"><span class="n">steps</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">seed</span><span class="o">=</span><span class="default_value">'43'</span></em>, <em class="sig-param"><span class="n">num_facet</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">L1</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#MCMC.AHMC" title="Permalink to this definition">¶</a></dt>
<dd><p>This function initializes a Theta value and then advances the hamiltonian
for a certain amount of values.</p>
</dd></dl>

<dl class="py function">
<dt id="MCMC.adapt_ADHMC">
<code class="sig-prename descclassname">MCMC.</code><code class="sig-name descname">adapt_ADHMC</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">e</span></em>, <em class="sig-param"><span class="n">diff</span></em>, <em class="sig-param"><span class="n">err</span></em>, <em class="sig-param"><span class="n">count</span></em><span class="sig-paren">)</span><a class="headerlink" href="#MCMC.adapt_ADHMC" title="Permalink to this definition">¶</a></dt>
<dd><p>This function should attempt to optimize the value of e picked for the
adaptive Hamiltonian MCMC runs. We know that there are areas of the
parameter space which are prone to large errors and some areas prone to
small areas. This seeks to take in the previous time step and the amount of
error that occured in the Hamiltonian and then adapt it to better suit the
range we are in.</p>
</dd></dl>

<dl class="py function">
<dt id="MCMC.check_theta">
<code class="sig-prename descclassname">MCMC.</code><code class="sig-name descname">check_theta</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">theta</span></em>, <em class="sig-param"><span class="n">p</span></em>, <em class="sig-param"><span class="n">N</span></em><span class="sig-paren">)</span><a class="headerlink" href="#MCMC.check_theta" title="Permalink to this definition">¶</a></dt>
<dd><p>This ensures that the new theta value is comprised of valid inputs in our
parameter space. We perform a reflection in order to preserve the
Hamiltonian’s phase space volume. (Liouville’s Theorem)</p>
<p>Implementation based on the implementation for a bounded HMC from
Dr. Radford M. Neal’s GRIMS: <a class="reference external" href="http://www.cs.utoronto.ca/~radford/GRIMS.html">http://www.cs.utoronto.ca/~radford/GRIMS.html</a></p>
</dd></dl>

<dl class="py function">
<dt id="MCMC.fix_illcondition">
<code class="sig-prename descclassname">MCMC.</code><code class="sig-name descname">fix_illcondition</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">M</span></em><span class="sig-paren">)</span><a class="headerlink" href="#MCMC.fix_illcondition" title="Permalink to this definition">¶</a></dt>
<dd><p>As the FIM becomes ill-defined when two of the parameters converge to their
truth values, causing the final parameter to greatly increase and thereby
throw the parameters off, we must check the FIM to ensure it is well
behaved, else we approximate it’s inverse with a new method proposed in the
paper:</p>
<blockquote>
<div><p><a class="reference external" href="https://core.ac.uk/download/pdf/26121748.pdf">https://core.ac.uk/download/pdf/26121748.pdf</a></p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt id="MCMC.get_FIM">
<code class="sig-prename descclassname">MCMC.</code><code class="sig-name descname">get_FIM</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">theta</span></em><span class="sig-paren">)</span><a class="headerlink" href="#MCMC.get_FIM" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the Fisher information Matrix which becomes our mass matrix in
the RMHC</p>
<p>From equation 25/28</p>
</dd></dl>

<dl class="py function">
<dt id="MCMC.get_derivates_flux">
<code class="sig-prename descclassname">MCMC.</code><code class="sig-name descname">get_derivates_flux</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">theta</span></em>, <em class="sig-param"><span class="n">t</span></em><span class="sig-paren">)</span><a class="headerlink" href="#MCMC.get_derivates_flux" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the derivative of the flux</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta</strong> (<em>TYPE</em>) – DESCRIPTION.</p></li>
<li><p><strong>t</strong> (<em>TYPE</em>) – DESCRIPTION.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>df</strong> – DESCRIPTION.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>TYPE</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="MCMC.get_potential">
<code class="sig-prename descclassname">MCMC.</code><code class="sig-name descname">get_potential</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">theta</span></em>, <em class="sig-param"><span class="n">N</span></em>, <em class="sig-param"><span class="n">L1</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#MCMC.get_potential" title="Permalink to this definition">¶</a></dt>
<dd><p>This function should generate the sampling from the new theta
distribution that has been passed in.</p>
</dd></dl>

<dl class="py function">
<dt id="MCMC.grad_potential">
<code class="sig-prename descclassname">MCMC.</code><code class="sig-name descname">grad_potential</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">theta</span></em>, <em class="sig-param"><span class="n">N</span></em>, <em class="sig-param"><span class="n">L1</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">lamda</span><span class="o">=</span><span class="default_value">1000</span></em><span class="sig-paren">)</span><a class="headerlink" href="#MCMC.grad_potential" title="Permalink to this definition">¶</a></dt>
<dd><p>This function generates the gradient vector for the likelihood function
based on the derivative I calculated. It takes the lightcurve and gets the
difference between the flux and expected flux to find out differences.</p>
<p>For use in equation 24/function hamiltonian</p>
</dd></dl>

<dl class="py function">
<dt id="MCMC.hamiltonian">
<code class="sig-prename descclassname">MCMC.</code><code class="sig-name descname">hamiltonian</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">curr_theta</span></em>, <em class="sig-param"><span class="n">L</span></em>, <em class="sig-param"><span class="n">e</span></em>, <em class="sig-param"><span class="n">L1</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#MCMC.hamiltonian" title="Permalink to this definition">¶</a></dt>
<dd><p>This function seeks to define and return the structure of the Hamiltonian
for use in the acception/rejection process</p>
<p>From Section 4</p>
</dd></dl>

<span class="target" id="module-stat_dists"></span><p>Implementing the different statistical distributions that are listed in the
paper.</p>
<p>&#64;author John Lewis Corker</p>
<dl class="py function">
<dt id="stat_dists.get_flux_measurement">
<code class="sig-prename descclassname">stat_dists.</code><code class="sig-name descname">get_flux_measurement</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time</span></em>, <em class="sig-param"><span class="n">theta</span></em>, <em class="sig-param"><span class="n">num_facets</span></em><span class="sig-paren">)</span><a class="headerlink" href="#stat_dists.get_flux_measurement" title="Permalink to this definition">¶</a></dt>
<dd><p>This function calculates the hypothetical measured flux of a non-Lambertian
BDRF light curve</p>
<p>From equation 4</p>
</dd></dl>

<dl class="py function">
<dt id="stat_dists.likelihood_L1_dist">
<code class="sig-prename descclassname">stat_dists.</code><code class="sig-name descname">likelihood_L1_dist</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">theta</span></em>, <em class="sig-param"><span class="n">lightcurve</span></em>, <em class="sig-param"><span class="n">samples</span></em>, <em class="sig-param"><span class="n">facets</span></em>, <em class="sig-param"><span class="n">obs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#stat_dists.likelihood_L1_dist" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine a representative sample of the likihood function</p>
<p>This uses the distribution from the scipy_dist class.</p>
<p>From equation 10</p>
</dd></dl>

<dl class="py function">
<dt id="stat_dists.likelihood_dist">
<code class="sig-prename descclassname">stat_dists.</code><code class="sig-name descname">likelihood_dist</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">theta</span></em>, <em class="sig-param"><span class="n">lightcurve</span></em>, <em class="sig-param"><span class="n">samples</span></em>, <em class="sig-param"><span class="n">facets</span></em>, <em class="sig-param"><span class="n">obs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#stat_dists.likelihood_dist" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine a representative sample of the likihood function</p>
<p>This uses the distribution from the scipy_dist class.</p>
<p>From equation 10</p>
</dd></dl>

<dl class="py function">
<dt id="stat_dists.theta_prior">
<code class="sig-prename descclassname">stat_dists.</code><code class="sig-name descname">theta_prior</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">theta_obj</span></em>, <em class="sig-param"><span class="n">lightcurve</span></em><span class="sig-paren">)</span><a class="headerlink" href="#stat_dists.theta_prior" title="Permalink to this definition">¶</a></dt>
<dd><p>The prior distribution for the input parameters in the start of the run.</p>
<p>From equation 9</p>
</dd></dl>

<dl class="py function">
<dt id="stat_dists.visibility_prior">
<code class="sig-prename descclassname">stat_dists.</code><code class="sig-name descname">visibility_prior</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">num_obs</span></em>, <em class="sig-param"><span class="n">vector</span></em>, <em class="sig-param"><span class="n">lightcurve</span></em><span class="sig-paren">)</span><a class="headerlink" href="#stat_dists.visibility_prior" title="Permalink to this definition">¶</a></dt>
<dd><p>A distribution which 0 if the facet is not reflextive and 1 if it is curr.
reflecting light towards the observer. m is the maximum time of
measurements</p>
<p>From eauation 8</p>
</dd></dl>

<span class="target" id="module-scipy_dist"></span><p>A stats class which is the combination of the pdf’s for two
other relevant distributions.</p>
<p>&#64;author John Lewis Corker</p>
<dl class="py class">
<dt id="scipy_dist.L1_norm_likelihood">
<em class="property">class </em><code class="sig-prename descclassname">scipy_dist.</code><code class="sig-name descname">L1_norm_likelihood</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">momtype</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">a</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">b</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">xtol</span><span class="o">=</span><span class="default_value">1e-14</span></em>, <em class="sig-param"><span class="n">badvalue</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">longname</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">shapes</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">extradoc</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">seed</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#scipy_dist.L1_norm_likelihood" title="Permalink to this definition">¶</a></dt>
<dd><p>The subclass that defines the baysian version of equation 29 in the paper.</p>
</dd></dl>

<dl class="py class">
<dt id="scipy_dist.likelihood">
<em class="property">class </em><code class="sig-prename descclassname">scipy_dist.</code><code class="sig-name descname">likelihood</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">momtype</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">a</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">b</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">xtol</span><span class="o">=</span><span class="default_value">1e-14</span></em>, <em class="sig-param"><span class="n">badvalue</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">longname</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">shapes</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">extradoc</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">seed</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#scipy_dist.likelihood" title="Permalink to this definition">¶</a></dt>
<dd><p>A subclass which describes the combination of the likelihood function
<a class="reference external" href="https://arxiv.org/pdf/math/0604627.pdf">https://arxiv.org/pdf/math/0604627.pdf</a></p>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, John Lewis Corker

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>